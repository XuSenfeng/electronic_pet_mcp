# 显示界面

## 普通界面

这部分是已经固定功能的部分

+ 状态显示
+ 商店界面
+ 说明目录

实现的基本思路

> 小智原有的界面是主界面`screen_main_`, 这个界面不删除, 只是添加隐藏的标志位

1. 创建一个单独的content用容器, 在里面记录实际的显示界面, 在退出界面的时候使用`lv_obj_del`函数进行界面的删除
2. 使用变量`screen_now_`记录当前的界面, 根据这个用于切换不同的界面时候判当前位置
3. 进行界面设置的时候**一定要加锁!!!**, 否则程序随时可能跑死

## 界面切换

### 立创

立创的板子没有那么多按键, 所以使用陀螺仪进行不同按键的模拟

使用上下作用倾斜进行界面的切换, 之前使用手势进行界面的切换, 但是我的lvgl调教的效果不好, 所以后续没有使用

```
												 说明界面
													||
													||
										商店 ===== 主界面 ====== 状态界面
													||
													||
												  目录界面
```

> 代码的实现在qmi8658.h里面

### XvsenfengAI

使用按钮进行界面的切换, 左侧的是原有的小智的对话状态的切换, 中间的按键可以实现不同的页面变化, 右侧按键用于返回上一级界面

所有的代码实现是在板级文件里面实现

## 游戏目录界面

在游戏部分的界面使用目录的形式实现, 只需要按照规定的格式即可实现界面的添加以及显示

在游戏界面, 由于所有的界面, 都使用同一个obj记录当前的界面, 所以在切换界面之前需要先删除之前的界面, 之后重新创建当前界面

想在目录里面添加新的内容的时候, 直接把界面的名字以及界面的注册在对应的数组里面即可

```c
GameScreen game_screen_list[] = {
    {
        .title = "角色扮演",
        .UIFunc = &LcdDisplay::AIPlayGameUI
    },
    
    {
        .title = "对话记录",
        .UIFunc = &LcdDisplay::MessageUI
    }
};
```

### 自动息屏

分析一下需要处理的情况

+ 空闲状态的时候一定时间以后进行息屏
+ 息屏的时候需要记录息屏之前的状态=>用于亮屏的时候返回
+ 按键按下的时候第一次进行亮屏, 第二次才是对话
+ 说啥的时候以及功能界面的时候不可以进行息屏

实际实现的时候, 需要实现一个周期为1s的闹钟, 同时根据状态机的情况进行处理不同页面的时钟计时策略, 在设置屏幕亮度的时候需要处理事用户主动的处理还是自动息屏的处理

